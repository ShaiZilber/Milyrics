<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milyrics</title>
    <link rel="stylesheet" type="text/css" href="static\\styles\\styles.css">
</head>
<body>
    <form id="searchForm">
        <input id="searchInput" type="text" placeholder="Enter song name...">
        <button type="submit">Search</button>
    </form>
    <div id="songsList"></div>
    <div id="gameContainer" style="display:none;">
        <h1 id="songTitle"></h1>
        <input type="text" id="userInput" placeholder="Guess a word...">
        <div id="lyricsContainer"></div>
        <button id="resetBtn">RESET</button>
        <button id="giveUpBtn">Give Up</button>
        <button id="backBtn">Back</button>
    </div>
    <script>
        let lyricsData = [];
        let words = [];
        let correct = [];

        async function loadLyrics() {
            let response = await fetch('lyrics.json');
            lyricsData = await response.json();
        }

        document.getElementById('searchForm').addEventListener('submit', function(e) {
            e.preventDefault();
            let query = document.getElementById('searchInput').value.toLowerCase();
            let songsList = document.getElementById('songsList');
            songsList.innerHTML = '';

            for (let song of lyricsData) {
                if (song.song.toLowerCase().includes(query)) {
                    let songLink = document.createElement('a');
                    songLink.href = '#';
                    songLink.textContent = `${song.song} | ${song.artist}`;
                    songLink.onclick = function() { startGame(song); };
                    songsList.appendChild(songLink);
                    songsList.appendChild(document.createElement('br'));
                }
            }
        });

        function startGame(song) {
            document.getElementById('songsList').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'block';
            document.getElementById('songTitle').textContent = `${song.song} | ${song.artist}`;
            words = JSON.parse(song.songs.replace(/'/g, '"'));
            correct = new Array(words.length).fill(false);
            updateLyricsDisplay();
        }

        function updateLyricsDisplay(giveUp = false) {
            let lyricsContainer = document.getElementById('lyricsContainer');
            lyricsContainer.innerHTML = '';
            words.forEach((word, i) => {
                let span = document.createElement('span');
                if (correct[i]) {
                    span.textContent = word + ' ';
                    span.classList.add('known');
                } else if (giveUp) {
                    span.textContent = word + ' ';
                } else {
                    span.textContent = '____ ';
                    span.classList.add('unknown');
                }
                lyricsContainer.appendChild(span);
            });
        }

        document.getElementById('userInput').addEventListener('input', function() {
            let inputValue = this.value.trim().toLowerCase();
            words.forEach((word, i) => {
                if (word.toLowerCase() === inputValue && !correct[i]) {
                    correct[i] = true;
                    this.value = '';
                }
            });
            updateLyricsDisplay();

        });

        document.getElementById('resetBtn').addEventListener('click', function() {
            correct.fill(false);
            updateLyricsDisplay();
        });

        document.getElementById('giveUpBtn').addEventListener('click', function() {
            updateLyricsDisplay(true);
        });

        document.getElementById('backBtn').addEventListener('click', function() {
            document.getElementById('songsList').style.display = 'block';
            document.getElementById('gameContainer').style.display = 'none';
        });

        loadLyrics();
    </script>
</body>
</html>
